# Maintainer: Pops Dylan <popsdylan@protonmail.com>
pkgname=bootchart2
pkgver=0.14.9_git20220807
pkgrel=0
pkgdesc="Boot Process Performance Visualization"
url="https://github.com/xrmx/bootchart"
arch="all"
license="GPL-2.0-only"
depends="python3 py3-cairo"
makedepends="$depends_dev sed linux-headers"
subpackages="$pkgname-doc"
_commit="3d2136d0335718fbe1a8e2370ccbc30123a6e593"
source="bootchart-$_commit.tar.gz::https://github.com/xrmx/bootchart/archive/$_commit.tar.gz
	10-set-EXIT_PROC.patch
	"
builddir="$srcdir/bootchart-$_commit"
options="!check"

build() {
	make PYTHON=python3 all
}

check() {
	make check
}

package() {
	# install everything but the service
	for target in "py-install-compile" "install-collector" "install-docs"; do
		make PYTHON=python3 EARLY_PREFIX="/usr" DESTDIR="$pkgdir" "$target"
	done
}

sha512sums="
ba5deaeff4ee1eac905ed8200dc1fc3157df10eddf2aabe22ec61a5e2ae4300d4b6fd7ab74baaca07e01d1813751f19f206b77441459f166d303634587fdea67  bootchart-3d2136d0335718fbe1a8e2370ccbc30123a6e593.tar.gz
0ab20745b0eb360ca1795017f3f2e18b39097f7720816f636d69e91fa01eba7d2fc8971e20d5ab73cff17c89174051982ea8d676319848fb8dee3d2cdbccbd79  10-set-EXIT_PROC.patch
"
